$(document).on("wb-ready.wb",function(){$.i18n().load({en:"./assets/js/i18n/en.json",fr:"./assets/js/i18n/fr.json"}).done(function(){$("html").i18n();$(".app-name").addClass("hidden");$("#allspan").removeClass("hidden");tippy("[data-template]",{content(e){e=e.getAttribute("data-template");return $.i18n(e)},allowHTML:!0})});let a=getQueryParams();var b=getSpecifiedParam(a,"url");var c=getSpecifiedParam(a,"start");var d=getSpecifiedParam(a,"end");date=getSpecifiedParam(a,"date");c&&d&&(c=moment(c).format("MMMM D, YYYY"),d=moment(d).format("MMMM D, YYYY"),$(".dr-date-start").html(c),$(".dr-date-end").html(d));b&&($("#urlval").val(b),$.isNumeric(date)&&$("#date-range").val(date).change(),mainQueue(b,c,d,0))});function getQueryParams(){let a={},b=window.location.search;b=b.substr(1);b.split("&").forEach(function(c){c=c.split("=");a[c[0]]=decodeURIComponent(c[1])});return a}function extractJSON(a,b){var c=!1;for(const d in a)Array.isArray(a[d])||"object"===typeof a[d]?(console.log(b+d+" is array or object"),c=extractJSON(a[d],b+" > "+d+" > "),"error"===d&&(c=!0,console.log(c))):(console.log(b+d+": "+a[d]),"error"===d?(c=!0,$("#errorHeader").html(a[d]),console.log(c)):"message"===d&&(c=!0,$("#errorDetails").html(a[d]),console.log(c)));return c}function setQueryParams(a,b){window.history.pushState("Query Parameters","Addition of Queries","?url="+a+"&date="+b+"&lang="+document.documentElement.lang)}function getSpecifiedParam(a,b){for(let [c,d]of Object.entries(a))if(c===b)return d}const kFormatter=a=>999<Math.abs(a)?Math.sign(a)*(Math.abs(a)/1E3).toFixed(1)+"k":Math.sign(a)*Math.abs(a),dynamicColors=()=>"rgba("+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+","+Math.floor(200*Math.random())+", 0.7)",poolColors=a=>{var b=[];for(i=0;i<a;i++)b.push(dynamicColors());return b};function isInt(a){return!isNaN(a)&&parseInt(Number(a))==a&&!isNaN(parseInt(a,10))}function generateTableHead(a,b,c){a.createCaption().innerHTML="<div class='wb-inv'>"+c+"</div";a=a.createTHead().insertRow();for(let d of b)b=document.createElement("th"),c=document.createTextNode(d),b.setAttribute("scope","col"),b.appendChild(c),a.appendChild(b)}function generateTable(a,b){for(let d of b)for(c in b=a.insertRow(),d){var c=d[c];let e=b.insertCell();isInt(c)&&(c=c.toLocaleString(document.documentElement.lang+"-CA"));e.insertAdjacentHTML("beforeend",c)}}function getPDF2(){var a=[],b=new jsPDF;$.each(["#canvas-container"],function(c,d){console.log(d);c=$.Deferred();generateCanvas(d,b,c);a.push(c.promise())});$.when.apply($,a).then(function(){b.save("HTML-Document.pdf")})}function generateCanvas(a,b,c){var d=$(a).width(),e=$(a).height(),g=d+40,h=1.5*g+40,k=Math.ceil(e/h)-1;html2canvas($(a)[0],{allowTaint:!0,scrollX:0,scrollY:-window.scrollY}).then(function(m){m.getContext("2d");console.log(m.height+"  "+m.width);m=m.toDataURL("image/jpeg",1);var l=new jsPDF("p","pt",[g,h]);l.addImage(m,"JPG",20,20,d,e);for(var n=1;n<=k;n++)l.addPage(g,h),l.addImage(m,"JPG",20,-(h*n)+20*(2*n+1),d,e);c.resolve()})}function genPDF(){var a=new jsPDF;$.each(["#canvas-container"],function(b,c){console.log(c);b=$.Deferred();generateCanvas(c,a,b)});$.when.apply($,[]).then(function(){a.save("test.pdf")})}function generateCanvas2(a,b,c){html2canvas($(a)[0],{onrendered:function(d){d=d.toDataURL();b.addImage(d,"PNG");b.addPage();c.resolve()}})}function getPDF(){var a=$("main").width(),b=$("main").height(),c=a+40,d=1.5*c+40,e=Math.ceil(b/d)-1;html2canvas($("main")[0],{allowTaint:!0,scrollX:0,scrollY:-window.scrollY}).then(function(g){g.getContext("2d");console.log(g.height+"  "+g.width);g=g.toDataURL("image/jpeg",1);var h=new jsPDF("p","pt",[c,d]);h.addImage(g,"JPG",20,20,a,b);for(var k=1;k<=e;k++)h.addPage(c,d),h.addImage(g,"JPG",20,-(d*k)+20*(2*k+1),a,b);h.save("HTML-Document.pdf")})}function printToPDF(){console.log("converting...");var a=new jsPDF("p","pt","letter");a.addHTML($("#canvas-container")[0],{pagesplit:!0,background:"#fff"},function(){a.save("Test.pdf")})}const jsonPieGenerate=a=>{$("#chart").remove();$("#chart-canvas").append("<canvas id='chart'></canvas>");val=a;cnt=val.length;a=[];sum=val.reduce(function(d,e){return d+e},0);for(i=0;i<val.length;i++)value=val[i],per=parseFloat((100*value/sum).toFixed(0)),a.push(per);bgColor=["#56B4E9","#009E73","#0072B2","#000000"];a=[{data:a,backgroundColor:bgColor}];var b={responsive:!0,maintainAspectRatio:!1,plugins:{beforeInit:(d,e)=>{Chart.Legend.afterFit=function(){this.height+=50}},datalabels:{backgroundColor:function(d){return d.dataset.backgroundColor},borderRadius:4,color:"white",font:{weight:"bold",size:18}}},scales:{xAxes:[{gridLines:{display:!1},ticks:{fontSize:18},scaleLabel:{display:!0,labelString:$.i18n("DeviceType"),fontSize:18}}],yAxes:[{ticks:{fontSize:18,beginAtZero:!0,callback:function(d){return"fr"==document.documentElement.lang?d.toFixed(0)+" %":d.toFixed(0)+"%"},min:0,max:100,step:10},scaleLabel:{display:!0,labelString:$.i18n("Percentageofvisits"),fontSize:18}}]},tooltips:"false",legend:{display:!1},layout:{padding:{top:25}}},c=document.getElementById("chart").getContext("2d");b=new Chart(c,{type:"bar",data:{datasets:a,labels:[$.i18n("Desktop"),$.i18n("MobilePhone"),$.i18n("Tablet"),$.i18n("Other")]},options:b});a=[];for(i=0;i<val.length;i++)value=val[i],lab=b.data.labels[i],per=parseFloat((100*value/sum).toFixed(2)).toLocaleString(document.documentElement.lang+"-CA"),per+="fr"==document.documentElement.lang?"&nbsp;%":"%",vals=value.toLocaleString(document.documentElement.lang+"-CA"),c={},c[$.i18n("DeviceType")]=lab,c[$.i18n("Visits")]=vals,c[$.i18n("Percent")]=per,a.push(c);b=document.querySelector("table#tbl-pltfrm");c=Object.keys(a[0]);b.innerHTML="";generateTable(b,a);generateTableHead(b,c,$.i18n("Percentage (%) of visits by device used"));$("#chart-pltfrms").show();$("#chrtp").hide()},RANGE=(a,b)=>Array.from(function*(c,d){for(;c<=d;)yield c++}(a,b));var numberWithCommas=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};const jsonTrendGenerate=(a,b,c)=>{a=a.rows;if(null!=a){$("#trends").remove();$("#trends-canvas").append("<canvas id='trends'></canvas>");for(var d=Object.keys(a),e=[],g=0;g<d.length;g++)e.push(a[d[g]].data);$cnt=e.length;val=e.slice(0,$cnt/2);lval=e.slice($cnt/2,$cnt);1==b?(val=val.slice(-7),lval=lval.slice(-7)):2==b&&(val=val.slice(-1),lval=lval.slice(-1));console.log(val);$cnt=val.length;b=[];var h=[];for(a=moment(c[0]);a.isBefore(c[1]);a.add(1,"days"))b.push(a.locale(document.documentElement.lang).format("MMM-DD")),h.push(a.locale(document.documentElement.lang).format("MMMM DD"));$rng=RANGE(1,$cnt);console.log($rng);const m="day".replace(/^\w/,n=>n.toUpperCase());c={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1}},scales:{yAxes:[{scaleLabel:{display:!0,labelString:$.i18n("Numberofvisits"),fontSize:18},ticks:{beginAtZero:!0,callback:function(n,p,q){return Intl.NumberFormat().format(n/1E3)},fontSize:18}}],xAxes:[{scaleLabel:{display:!0,labelString:$.i18n("Day"),fontSize:18},gridLines:{display:!1},ticks:{fontSize:18}}]},tooltips:"false",hover:{mode:"nearest",intersect:!0},legend:{position:"bottom",labels:{usePointStyle:!0,fontSize:18}},layout:{padding:{top:25}}};a=document.getElementById("trends").getContext("2d");var k=new Chart(a,{type:"line",data:{labels:b,datasets:[{label:$.i18n("CurrentYear"),data:val,borderColor:"#56B4E9",backgroundColor:"#56B4E9",fill:!1},{label:$.i18n("PreviousYear"),data:lval,borderColor:"#009E73",backgroundColor:"#009E73",fill:!1}]},options:c});let l=[];$.each(val,function(n,p){vals=val[n];lvals=lval[n];lab=k.data.labels[n];diff=((vals-lvals)/lvals*100).toFixed(1);diff="Infinity"==diff?$.i18n("NotAvailable"):"fr"==document.documentElement.lang?parseFloat(diff).toLocaleString(document.documentElement.lang+"-CA")+"&nbsp;%":parseFloat(diff)+"%";vals=val[n].toLocaleString(document.documentElement.lang+"-CA");lvals=lval[n].toLocaleString(document.documentElement.lang+"-CA");p={};p[$.i18n(m)]=h[n];p[$.i18n("CurrentYear")]=vals;p[$.i18n("PreviousYear")]=lvals;p[$.i18n("Difference")]=diff;l.push(p)});c=document.querySelector("table#tbl-trnds");b=Object.keys(l[0]);c.innerHTML="";generateTable(c,l);generateTableHead(c,b,$.i18n("Visitstrendbycurrentyearandpreviousyear"));$("#chart-trnds").show();$("#chrtt").hide()}else $("#chart-trnds").hide(),$("#chrtt").show()},jsonFile=a=>{},getPageTitle=a=>Object.keys(a).map((b,c)=>{b=a[b].value;b=-1!==b.indexOf("https://")?b:"https://"+b;if(-1!==b.indexOf("canada.ca"))return b=new Request(b,{method:"GET"}),fetch(b).then(d=>d.text()).then(d=>$(d).find("h1:first").text()).catch(console.error.bind(console))}),getPageH1=a=>{console.log("1: "+a);a=-1!==a.indexOf("https://")?a:"https://"+a;a=new Request(a,{method:"GET"});return fetch(a).then(b=>b.text()).then(b=>$(b).find("h1:first").text()).catch(console.error.bind(console))},getPage=a=>{a=-1!==a.indexOf("https://")?a:"https://"+a;if(-1!==a.indexOf("canada.ca"))return a=new Request(a,{method:"GET"}),fetch(a).then(b=>b.text()).then(b=>({html:b})).catch(console.error.bind(console))},jsonPrevious=(a,b)=>{var c=a.rows[0];title=$.i18n("Whereuserscamefrom");var d=$("#ppt");if(null!=c){a=a.rows;d.html("");var e=[];$.each(a,function(g,h){term=url=h.value;clicks=h.data[b];f="blank page url"==url?$.i18n("Directtraffic/Bookmark"):"<a href='"+url+"'>"+term+"</a>";g={};g[$.i18n("PreviouspageURL")]=f;g[$.i18n("Visits")]=clicks;e.push(g)});0!=e.length?($("#ppt").html(getTable(5,"false")),d=document.querySelector("#ppt table"),a=Object.keys(e[0]),generateTable(d,e),generateTableHead(d,a,title),$("#ppt table").trigger("wb-init.wb-tables")):d.html($.i18n("Nodata"))}else d.html($.i18n("Nodata"))},jsonForward=a=>{},jsonSnum=(a,b)=>{a=a.rows[0];var c=$("#snum"),d=parseInt($("#numDays").html());c.html("");if(null!=a)return snum=a.data[b],snumDays=parseInt(snum/d).toLocaleString(document.documentElement.lang+"-CA"),snum=parseInt(snum).toLocaleString(document.documentElement.lang+"-CA"),2==b?c.prepend("<span class='h1'>"+snum+"</span> <strong>"+$.i18n("total")+"</strong>"):c.prepend("<span class='h1'>"+snumDays+"</span> <strong>"+$.i18n("averageperday")+"</strong></br><span class='small'>"+snum+" "+$.i18n("total")+"</span>"),itemid=a.itemId;c.html($.i18n("Nodata"))},jsonSearches=(a,b)=>{if(null!=a.rows[0]){a=a.rows;var c=[];$.each(a,function(d,e){search=e.value;searchurl="https://www.canada.ca/en/revenue-agency/search.html?cdn=canada&st=s&num=10&langs=en&st1rt=1&s5bm3ts21rch=x&q="+search+"&_charset_=UTF-8&wb-srch-sub=";searchv=e.data[b];"0"!=searchv&&c.push({Term:search,url:searchurl,Clicks:searchv})});0!=c.length&&(c.sort((d,e)=>e.Clicks-d.Clicks),$.each(c,function(d,e){$search="#search"+d;$searchhtml=$($search);$searchhtml.html("");$($search).append("<a href='"+e.url+"'>"+e.Term+"</a>").append(" ("+e.Clicks.toLocaleString(document.documentElement.lang+"-CA")+")")}))}else a=Array(4),$search=$("#search0"),$search.html($.i18n("Nodata")),$.each(a,function(d,e){0!=d&&($search=$("#search"+d),$search.html(""))})},jsonDownload=a=>{var b=a.rows[0];$dwnld=$("#dwnld");if(null!=b){a=a.rows;$dwnld.html("");$dwnld.append($("<ul class='colcount-sm-2'>"));$dwnld=$("#dwnld ul");var c=[],d=[];$.each(a,function(h,k){h=k.value;k=k.data[0];h.includes(".pdf")?(h.includes("-lp")&&(type="Large Print"),type=h.includes("-fill-")?"Fillable":"Flat"):type=h.includes(".txt")?"E-Text":h.split("/").pop().split(".").pop().toUpperCase();var m=h.split("/").pop();c.push(h);d.push({term:h,clicks:k,type,filename:m})});$url="https://www.canada.ca/en/revenue-agency/services/forms-publications/td1-personal-tax-credits-returns/td1-forms-pay-received-on-january-1-later/td1.html";a=$url.split("/").pop().split(".").shift();var e=c.findReg("^https://www.canada.ca/.*?"+a+"-(fill-)*([0-9]{1,2})"),g=$("#np");g.html("");g.append($("<ul class='colcount-sm-2>"));g=$("#np ul");$.each(d,function(h,k){$.each(e,function(m,l){k.term==l&&g.append($("<li>").append(k.filename+" ("+k.clicks.toLocaleString(document.documentElement.lang+"-CA")+") [<em>"+k.type+"</em>]"))})})}else $dwnld.html($.i18n("Nodata"))},jsonOutbound=(a,b)=>{var c=a.rows[0];$outbnd=$("#outbnd");if(null!=c){var d=a.rows;$outbnd.html("");$outbnd.append($("<ul class='colcount-sm-2'>"));$outbnd=$("#outbnd ul");Promise.all([getPage(b)]).then(e=>{$.each(d,function(g,h){text=h.value;outbnd=h.data[0];$outbnd.append($("<li>").append(text+" ("+outbnd.toLocaleString(document.documentElement.lang+"-CA")+")"))})})}else $outbnd.html($.i18n("Nodata"))},jsonRT=(a,b)=>{val="#reft";title=$.i18n("Referringtypes");b=$(val);b.html("");var c=[];$.each(a,function(d,e){term=e[0];clicks=e[1];d={};d[$.i18n("Type")]=$.i18n(term.replace(/\s/g,""));d[$.i18n("Visits")]=clicks;c.push(d)});0!=c.length?($(val).html(getTable(5,"false","false","false")),a=document.querySelector(val+" table"),b=Object.keys(c[0]),generateTable(a,c),generateTableHead(a,b,title),$(val+" table").trigger("wb-init.wb-tables")):b.html($.i18n("Nodata"))},jsonTable=(a,b,c,d,e)=>{c=$.i18n(c);e=$(b);e.html("");var g=[];$.each(a,function(h,k){console.log(a);h={};for(var m=0;m<d.length;m++){term=k[m];console.log(term);if(!isInt(term)&&-1!==term.indexOf("||")){var l=term.split("||");1<l.length&&(term="en"==document.documentElement.lang?l[0]:l[1])}h[$.i18n(d[m])]=term}g.push(h)});if(0!=g.length){$(b).html(getTable(10,"false","false","false"));e=document.querySelector(b+" table");let h=Object.keys(g[0]);generateTable(e,g);generateTableHead(e,h,c);$(b+" table").trigger("wb-init.wb-tables")}else e.html($.i18n("Nodata"))};function getTable(a=null,b=null,c=null,d=null,e=null,g=null,h=null,k=null,m=null){k||="wb-tables table table-responsive";a||=5;b||=!1;c||=!0;d||=!0;e||=[1,"&quot;desc&quot;"];g||=[5,10,25,-1];h||=[5,10,25,"&quot;All&quot;"];m?"gsc-tables"==m&&(m=["{ &quot;type&quot;: &quot;html&quot; }","{ &quot;type&quot;: &quot;formatted-num&quot; }","{ &quot;type&quot;: &quot;formatted-num&quot; }","{ &quot;type&quot;: &quot;formatted-num&quot; }","{ &quot;type&quot;: &quot;formatted-num&quot; }"]):m=["{ &quot;type&quot;: &quot;html&quot; }","{ &quot;type&quot;: &quot;formatted-num&quot; }"];return'<table class="'+k+"\" data-wb-tables='{ &quot;pageLength&quot; : "+a+", &quot;order&quot; : [ "+e+" ] , &quot;lengthMenu&quot; : [ [ "+g+" ], [ "+h+" ] ] ,&quot;searching&quot; : "+b+",&quot;info&quot; : "+c+",&quot;lengthChange&quot; : "+d+",&quot;columns&quot; : [ "+m+" ] }'></table>"}const jsonSearch=(a,b,c,d)=>{var e=a.rows[0],g=$(b);if(null!=e){a=a.rows;g.html("");var h=[];$.each(a,function(k,m){term=m.value;clicks=m.data[d];"(Low Traffic)"!=term&&"Unspecified"!=term&&0!=clicks&&(k={},k[$.i18n("Term")]=term,k[$.i18n("Searches")]=clicks,h.push(k))});0!=h.length?($(b).html(getTable(10)),b=document.querySelector(b+" table"),g=Object.keys(h[0]),generateTable(b,h),generateTableHead(b,g,c)):g.html($.i18n("Nodata"))}else g.html($.i18n("Nodata"))},jsonSearchesPhrases=(a,b)=>{var c=$.i18n("Searches from page");jsonSearch(a,"#srchP",c,b);$("#srchP table").trigger("wb-init.wb-tables")},jsonSearchesAll=(a,b)=>{var c=$.i18n("Searches to page");jsonSearch(a,"#srchA",c,b);$("#srchA table").trigger("wb-init.wb-tables")},jsonSearchesInstitution=a=>{var b=$.i18n("Contextualsearchestopage");jsonSearch(a,"#srchI",b);$("#srchI").trigger("wb-init.wb-tables")},jsonSearchesGlobal=a=>{var b=$.i18n("Globalsearchestopage");jsonSearch(a,"#srchG",b);$("#srchG").trigger("wb-init.wb-tables")};function sortByCol(a){return a.sort((b,c)=>c.Clicks-b.Clicks)}const jsonAM=(a,b)=>{var c=a.rows[0],d=$("#np");if(null!=c){a=a.rows;d.html("");var e=[];$.each(a,function(g,h){term=h.value;clicks=h.data[b];"(Low Traffic)"!=term&&"Unspecified"!=term&&(g={},g[$.i18n("LinkText")]=term,g[$.i18n("Clicks")]=clicks,e.push(g))});0!=e.length?(d.html(getTable(10)),d=document.querySelector("#np table"),a=Object.keys(e[0]),generateTable(d,e),generateTableHead(d,a,$.i18n("OutboundClicksonPage")),$("#np table").trigger("wb-init.wb-tables")):d.html($.i18n("Nodata"))}else d.html($.i18n("Nodata"))},jsonFWYLF=(a,b)=>{var c=a.rows[0],d=$("#fwylfReason"),e=$.i18n("NoClicks");arrEn=["I can't find the information","The information is hard to understand","There was an error / something didn't work","Other reason"];arrFr=["Je ne peux pas trouver l\u2019information","L'information est difficile \u00e0 comprendre","Il y avait une erreur / quelque chose ne fonctionnait pas","Autre raison"];if(null!=c){a=a.rows;d.html("");var g=[];$.each(a,function(h,k){term=k.value;clicks=k.data[b];h={};k=term.split("-");term=1<k.length?"en"==document.documentElement.lang?k[0]:k[1]:$.i18n(k[0]);if("fr"==document.documentElement.lang)for(i=0;i<arrEn.length;i++)if(term==arrEn[i]){term=arrFr[i];break}h[$.i18n("Reason")]=term;h[$.i18n("Submits")]=clicks;g.push(h)});0!=g.length?(d.html(getTable(10,"false","false","false")),d=document.querySelector("#fwylfReason table"),a=Object.keys(g[0]),generateTable(d,g),generateTableHead(d,a,e),$("#fwylfReason table").trigger("wb-init.wb-tables")):d.html($.i18n("Nodata"))}},jsonMetrics=(a,b)=>{a=a.summaryData.filteredTotals;var c=$("#uv");$("#uniquevisit");var d=$("#visit"),e=$("#pagev"),g=$("#avgtime"),h=parseInt($("#numDays").html());parseFloat($("#numWeeks").html());var k=0+parseInt(b),m=6+parseInt(b),l=9+parseInt(b),n=24+parseInt(b),p=30+parseInt(b),q=12+parseInt(b),r=15+parseInt(b),t=18+parseInt(b),u=21+parseInt(b),v=45+parseInt(b),w=48+parseInt(b),y=51+parseInt(b),z=54+parseInt(b),A=57+parseInt(b),B=60+parseInt(b),C=63+parseInt(b),D=66+parseInt(b),E=69+parseInt(b),F=72+parseInt(b),G=75+parseInt(b),H=78+parseInt(b),I=81+parseInt(b),J=84+parseInt(b),K=87+parseInt(b),L=90+parseInt(b),M=93+parseInt(b),N=96+parseInt(b),O=111+parseInt(b),P=114+parseInt(b),Q=117+parseInt(b),R=120+parseInt(b),S=123+parseInt(b),T=126+parseInt(b),U=129+parseInt(b),V=132+parseInt(b),W=135+parseInt(b),X=138+parseInt(b),Y=141+parseInt(b),Z=144+parseInt(b),aa=147+parseInt(b),ba=150+parseInt(b),ca=99+parseInt(b),da=102+parseInt(b),ea=105+parseInt(b),fa=108+parseInt(b);c.html("");d.html("");e.html("");g.html("");null!=a?(uv=parseInt(a[l]),uvDays=parseInt(uv/h).toLocaleString(document.documentElement.lang+"-CA"),uv=parseInt(uv).toLocaleString(document.documentElement.lang+"-CA"),visit=parseInt(a[m]),vDays=parseInt(visit/h).toLocaleString(document.documentElement.lang+"-CA"),visit=parseInt(visit).toLocaleString(document.documentElement.lang+"-CA"),pv=parseInt(a[k]),pvDays=parseInt(pv/h).toLocaleString(document.documentElement.lang+"-CA"),pv=parseInt(pv).toLocaleString(document.documentElement.lang+"-CA"),atMin=moment.utc(1E3*a[n]).format("m"),atSec=moment.utc(1E3*a[n]).format("ss"),g.prepend("<span class='h2'>"+atMin+" min "+atSec+" sec</span>"),2===b?(c.prepend("<span class='h2'>"+uv+"</span>"),d.prepend("<span class='h2'>"+visit+"</span>"),e.prepend("<span class='h2'>"+pv+"</span>"),g.closest("section").height("98px")):(c.prepend("<span class='h2'>"+uv+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+uvDays+"</div>"),d.prepend("<span class='h2'>"+visit+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vDays+"</div>"),e.prepend("<span class='h2'>"+pv+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+pvDays+"</div>"),g.closest("section").height("138px")),NaN==parseInt(a[z])||0==parseInt(a[v])?($("#rapCont").html('<p id="rap"></p>'),rap=parseInt(a[p]),rapDays=Math.round(rap/h).toLocaleString(document.documentElement.lang+"-CA"),rap=parseInt(rap).toLocaleString(document.documentElement.lang+"-CA"),2==b?$("#rap").prepend("<span class='h1'>"+rap+"</span> <strong>"+$.i18n("total")+"</strong>"):$("#rap").prepend("<span class='h1'>"+rapDays+"</span> <strong>"+$.i18n("averageperday")+"</strong></br><span class='small'>"+rap+" "+$.i18n("total")+"</span>"),$("#fwylfCont").html('<div id="fwylfTable"></div><div id="fwylfReason"></div>'),$("#rap-container").show(),$("#fwylf-container").hide()):($("#fwylfCont").html('<div id="fwylfTable"></div><div id="fwylfReason"></div>'),$("#fwylfTable").html('<table class="table table-striped"><thead><th scope="col">'+$.i18n("Yes")+'</th><th scope="col">'+$.i18n("No")+'</th></thead><tr><td id="fwylfYes"></td><td id="fwylfNo"></td></tr></table>'),$("#fwylfYes").html(a[y]),$("#fwylfNo").html(a[w]),$("#rapCont").html(""),$("#rap-container").hide(),$("#fwylf-container").show()),desktop=parseInt(a[q]),mobile=parseInt(a[r]),tablet=parseInt(a[t]),other=parseInt(a[u]),jsonPieGenerate([desktop,mobile,tablet,other]),searchEngine=parseInt(a[ca]),otherWebsites=parseInt(a[da]),socialNetworks=parseInt(a[ea]),typedBookmarked=parseInt(a[fa]),jsonRT([["Search Engines",searchEngine],["Other Web Sites",otherWebsites],["Social Networks",socialNetworks],["Typed / Bookmarked",typedBookmarked]],b),rapVal="#rapReason",rapTitle=$.i18n("reportaproblem"),rapHeaders=[$.i18n("Itemsselected"),$.i18n("Timesreported")],rapICantFind=parseInt(a[O]),rapLoginError=parseInt(a[P]),rapOtherIssue=parseInt(a[Q]),rapSIN=parseInt(a[R]),rapInfoIsMissing=parseInt(a[S]),rapSecureKey=parseInt(a[T]),rapOtherLoginNotList=parseInt(a[U]),rapGCKey=parseInt(a[V]),rapInfoOutdated=parseInt(a[W]),rapSpellingMistake=parseInt(a[X]),rapPAC=parseInt(a[Y]),rapLinkButtonNotWork=parseInt(a[Z]),rap404=parseInt(a[aa]),rapBlank=parseInt(a[ba]),jsonTable([["I can't find what I'm looking for||Je n'arrive pas \u00e0 trouver ce que je cherche",rapICantFind],["Login error when trying to access an account (e.g. My Service Canada Account)||Message d'erreur \u00e0 l'ouverture de la session lorsque je tente d'acc\u00e9der \u00e0 un compte (ex. Mon dossier Service Canada)",rapLoginError],["Other issue not in this list||Autre probl\u00e8me qui ne figure pas sur cette liste",rapOtherIssue],["Social Insurance Number (SIN) validation problems||Probl\u00e8me li\u00e9 \u00e0 la validation du num\u00e9ro d'assurance sociale (NAS)",rapSIN],["Information is missing||Les renseignements sont incomplets",rapInfoIsMissing],["SecureKey Concierge (Banking Credential) access||Acc\u00e8s SecureKey Service de Concierge (justificatifs d'identit\u00e9 bancaires)",rapSecureKey],["Other login error not in this list||Autre erreur lors de l'ouverture de session qui ne figure pas sur cette liste",rapOtherLoginNotList],["GC Key access||Acc\u00e8s Cl\u00e9GC",rapGCKey],["Information is outdated or wrong||L'information n'est plus \u00e0 jour ou est erron\u00e9e",rapInfoOutdated],["It has a spelling mistake||Il y a une erreur d'orthographe ou de grammaire",rapSpellingMistake],["Personal Access Code (PAC) problems or EI Access Code (AC) problems||Probl\u00e8me avec le Code d'acc\u00e8s personnel (CAP) ou avec le Code d'acc\u00e8s (CA) de l'assurance emploi",rapPAC],["A link, button or video is not working||Un lien, un bouton ou une vid\u00e9o ne fonctionne pas",rapLinkButtonNotWork],["Report a problem submissions that are 404 Pages||Signaler un probl\u00e8me dans les soumissions de 404 pages",rap404],["Report a problem submissions with no boxes checked||Signaler une soumission de probl\u00e8me sans case coch\u00e9e",rapBlank]],rapVal,rapTitle,rapHeaders,b),provVal="#provChart",provTitle=$.i18n("provTerr"),provHeaders=[$.i18n("provTerrHeader"),"Visits"],provAlberta=parseInt(a[A]),provBC=parseInt(a[B]),provMB=parseInt(a[C]),provNB=parseInt(a[D]),provNFL=parseInt(a[E]),provNWT=parseInt(a[F]),provNS=parseInt(a[G]),provNV=parseInt(a[H]),provON=parseInt(a[I]),provOutCAN=parseInt(a[J]),provPEI=parseInt(a[K]),provQB=parseInt(a[L]),provSK=parseInt(a[M]),provYK=parseInt(a[N]),jsonTable([["Alberta||L'Alberta",provAlberta],["British Columbia||La Colombie-Britannique",provBC],["Manitoba||Le Manitoba",provMB],["New Brunswick||Le Nouveau-Brunswick",provNB],["Newfoundland and Labrador||La Terre-Neuve-et-Labrador",provNFL],["Northwest Territories||Les Territoires du Nord-Ouest",provNWT],["Nova Scotia||La Nouvelle-\u00c9cosse",provNS],["Nunavut||Le Nunavut",provNV],["Ontario||L'Ontario",provON],["Outside Canada||\u00c0 l'ext\u00e9rieur du Canada",provOutCAN],["Prince Edward Island||\u00cele-du-Prince-\u00c9douard",provPEI],["Quebec||Le Qu\u00e9bec",provQB],["Saskatchewan||La Saskatchewan",provSK],["Yukon (Territory)||Le Yukon (Territoire)",provYK]],provVal,provTitle,provHeaders,b)):(c.html("0"),$rap.html("0"))};function nFormatter(a,b){var c=[{value:1,symbol:""},{value:1E3,symbol:"K"},{value:1E6,symbol:"M"},{value:1E9,symbol:"G"},{value:1E12,symbol:"T"},{value:1E15,symbol:"P"},{value:1E18,symbol:"E"}],d;for(d=c.length-1;0<d&&!(a>=c[d].value);d--);a=parseFloat((a/c[d].value).toFixed(b)).toLocaleString(document.documentElement.lang+"-CA");return a.replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+c[d].symbol}const jsonGSCTotal=(a,b)=>{a=a.rows;var c=$("#gsc-clicks"),d=$("#gsc-imp"),e=$("#gsc-ctr"),g=$("#gsc-pos"),h=parseInt($("#numDaysgsc").html());c.html("");d.html("");e.html("");g.html("");if(null!=a)for(let k of a)clicks=parseInt(k.clicks),fClicks=clicks.toLocaleString(document.documentElement.lang+"-CA"),vClicks=parseInt(clicks/h).toLocaleString(document.documentElement.lang+"-CA"),imp=parseInt(k.impressions),fImp=imp.toLocaleString(document.documentElement.lang+"-CA"),vImp=parseInt(imp/h).toLocaleString(document.documentElement.lang+"-CA"),2===b?(c.prepend("<span class='h2'>"+fClicks+"</span>"),d.prepend("<span class='h2'>"+fImp+"</span>")):(c.prepend("<span class='h2'>"+fClicks+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vClicks+"</div>"),d.prepend("<span class='h2'>"+fImp+"</span></br><div class='small'>"+$.i18n("Dailyaverage")+"</br>"+vImp+"</div>"));else c.html("0"),d.html("0"),e.html("0"),g.html("0")},jsonGSCGenerate=(a,b)=>{a=a.rows;if(null!=a){$("#gsc").remove();$("#gsc-canvas").append("<canvas id='gsc'></canvas>");$cnt=a.length;var c=[],d=[],e=[],g=[];$.each(a,function(h,k){val=k;c.push(parseInt(val.clicks));d.push(parseInt(val.impressions));k=moment(val.keys[0]).locale(document.documentElement.lang).format("MMM-DD");h=moment(val.keys[0]).locale(document.documentElement.lang).format("MMMM DD, YYYY");e.push(k);k={};k[$.i18n("Day")]=h;k[$.i18n("Clicks")]=val.clicks.toLocaleString(document.documentElement.lang+"-CA");k[$.i18n("Impressions")]=val.impressions.toLocaleString(document.documentElement.lang+"-CA");g.push(k)});a={plugins:{datalabels:{display:!1}},responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{id:"y-axis-0",type:"linear",display:!0,position:"left",ticks:{beginAtZero:!0,callback:function(h,k,m){return Intl.NumberFormat().format(h/1E3)},fontSize:18},scaleLabel:{display:!0,labelString:$.i18n("GSCClicks"),fontSize:18}},{id:"y-axis-1",type:"linear",display:!0,position:"right",ticks:{beginAtZero:!0,callback:function(h,k,m){return Intl.NumberFormat().format(h/1E3)},fontSize:18},scaleLabel:{display:!0,labelString:$.i18n("GSCImpressions"),fontSize:18}}],xAxes:[{scaleLabel:{display:!0,labelString:$.i18n("Dayofselecteddaterange2"),fontSize:18},ticks:{fontSize:18}}]},tooltips:!1,hover:{mode:"nearest",intersect:!0},legend:{position:"top",labels:{usePointStyle:!0}},layout:{padding:{top:25}}};Chart.defaults.global.showTooltips=!1;b=document.getElementById("gsc").getContext("2d");new Chart(b,{type:"line",data:{labels:e,datasets:[{yAxisID:"y-axis-0",label:$.i18n("Clicks"),data:c,fill:!1,borderColor:"#4285f4"},{yAxisID:"y-axis-1",label:$.i18n("Impressions"),data:d,fill:!1,borderColor:"#5e35b1"}]},options:a});a=document.querySelector("table#tbl-gsc");b=Object.keys(g[0]);a.innerHTML="";generateTable(a,g);generateTableHead(a,b,$.i18n("Visitstrendbycurrentyearandpreviousyear"));$("#chartgsc").show()}else $("#chartgsc").hide();$("#chrtgsc").hide()},jsonGSC=(a,b,c,d,e)=>{var g=a.rows,h=$(b);console.log(g);if(null!=g){a=a.rows;h.html("");var k=[];$.each(a,function(m,l){term=l.keys[e];clicks=l.clicks;imp=l.impressions;ctr=(100*l.ctr).toLocaleString(document.documentElement.lang+"-CA",{minimumFractionDigits:1,maximumFractionDigits:1});pos=l.position.toLocaleString(document.documentElement.lang+"-CA",{minimumFractionDigits:1,maximumFractionDigits:1});m="fr"==document.documentElement.lang?"&nbsp;%":"%";l={};l[d[0]]=term;l[d[1]]=clicks;l[d[2]]=imp;l[d[3]]=ctr+m;l[d[4]]=pos;k.push(l)});0!=k.length?($(b).html(getTable(10,null,null,null,null,null,null,null,"gsc-tables")),b=document.querySelector(b+" table"),h=Object.keys(k[0]),generateTable(b,k),generateTableHead(b,h,c)):h.html($.i18n("Nodata"))}else h.html($.i18n("Nodata"))},jsonGSCQryAll=(a,b)=>{b=$.i18n("All - Queries");var c=[$.i18n("Term"),$.i18n("Clicks"),$.i18n("Impressions"),$.i18n("CTR"),$.i18n("Position")];jsonGSC(a,"#gscQryAll",b,c,0);$("#gscQryAll table").trigger("wb-init.wb-tables")},jsonGSCQryMobile=(a,b)=>{b=$.i18n("Mobile - Queries");var c=[$.i18n("Term"),$.i18n("Clicks"),$.i18n("Impressions"),$.i18n("CTR"),$.i18n("Position")];jsonGSC(a,"#gscQryMob",b,c,0);$("#gscQryMob table").trigger("wb-init.wb-tables")},jsonGSCQryDesktop=(a,b)=>{b=$.i18n("Desktop - Queries");var c=[$.i18n("Term"),$.i18n("Clicks"),$.i18n("Impressions"),$.i18n("CTR"),$.i18n("Position")];jsonGSC(a,"#gscQryDesk",b,c,0);$("#gscQryDesk table").trigger("wb-init.wb-tables")},jsonGSCQryTablet=(a,b)=>{b=$.i18n("Desktop - Queries");var c=[$.i18n("Term"),$.i18n("Clicks"),$.i18n("Impressions"),$.i18n("CTR"),$.i18n("Position")];jsonGSC(a,"#gscQryTab",b,c,0);$("#gscQryTab table").trigger("wb-init.wb-tables")},jsonGSCCountry=(a,b)=>{lang="en"==document.documentElement.lang?0:1;b=$.i18n("Countries");var c=[$.i18n("Country"),$.i18n("Clicks"),$.i18n("Impressions"),$.i18n("CTR"),$.i18n("Position")];jsonGSC(a,"#gscCountry",b,c,lang);$("#gscCountry table").trigger("wb-init.wb-tables")};function search_country(a){var b=JSON.parse("../assets/js/json/country-en.json");condole.log(b);if(void 0!==a.id||void 0!==a.alpha2||void 0!==a.alpha3)return b.filter(function(c){return void 0!==a.id&&parseInt(c.id,10)===parseInt(a.id,10)||void 0!==a.alpha2&&c.alpha2===a.alpha2.toLowerCase()||void 0!==a.alpha3&&c.alpha3===a.alpha3.toLowerCase()}).pop()}function fetchWithTimeout(a,b,c,d){const e=new Promise(g=>{setTimeout(g,c,{timeout:!0})});return Promise.race([fetch(a,b),e]).then(g=>{g.timeout&&d();return g})}const apiCall=(a,b,c,d,e,g,h)=>c.map(k=>{url="fle"==k?"php/file.php":"php/process.php";post={dates:a,url:b,type:k,oUrl:d,field:g,lang:h};let m=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(m).then(l=>l.json()).then(l=>{console.log(k);console.log(l);if(l.error)return Promise.resolve(l);switch(k){case "fle":return jsonFile(l);case "snmAll":return jsonSnum(l,e);case "srchLeftAll":return jsonSearchesPhrases(l,e);case "trnd":return jsonTrendGenerate(l,e,a);case "prvs":return jsonPrevious(l,e);case "frwrd":return jsonForward(l);case "srchAll":return jsonSearchesAll(l,e);case "activityMap":return jsonAM(l,e);case "metrics-new":return jsonMetrics(l,e);case "fwylf":return jsonFWYLF(l,e);case "cntry":return jsonGSCCountry(l,e);case "qryAll":return jsonGSCQryAll(l,e);case "qryMobile":return jsonGSCQryMobile(l,e);case "qryDesktop":return jsonGSCQryDesktop(l,e);case "qryTablet":return jsonGSCQryTablet(l,e);case "totals":return jsonGSCTotal(l,e);case "totalDate":return jsonGSCGenerate(l,e)}}).catch(function(l){console.log(k);console.log(l.message);console.log(l.stack)})}),apiCall2=(a,b,c,d,e)=>c.map(g=>{url="php/process-new.php";post={dates:a,url:b,oUrl:d,lang:e};let h=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(h).then(k=>k.json()).then(k=>{$("#urlStatic").html("https://"+k.url);return k}).catch(function(k){console.log(g);console.log(k.message);console.log(k.stack)})}),apiCallGSC2=(a,b,c,d,e,g)=>c.map(h=>{url="php/process-gsc.php";post={dates:a,url:b,oUrl:d,day:e,lang:g};let k=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(k).then(m=>m.json()).then(m=>{var l=moment(m.start),n=moment(m.end),p=n.diff(l,"days")+1;$("#urlStatic").html(m.url);$("#fromGSC").html(m.start);$("#toGSC").html(m.end);l.locale(document.documentElement.lang);n.locale(document.documentElement.lang);l=l.format("dddd MMMM DD, YYYY");n=n.format("dddd MMMM DD, YYYY");$dd=$("#date-range").find(":selected").data("index");$("#fromdaterangegsc").html("<strong>"+l+"</strong>");$("#todaterangegsc").html("<strong>"+n+"</strong>");$("#numDaysgsc").html(p);return m}).catch(function(m){console.log(h);console.log(m.message);console.log(m.stack)})}),apiCallBP=(a,b,c,d)=>c.map(e=>{url="php/process-bp.php";post={dates:a,url:b,oUrl:d,lang:document.documentElement.lang};e=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(e).then(g=>g.json()).then(g=>{-1==g.html.indexOf("No data")?($("#bp-content").html(g.html),$("#bp-content").append("<p> For more options and date ranges, please visit <a href='https://feedback-by-page.tbs.alpha.canada.ca/bypage?page="+d+"' target='_blank'>https://feedback-by-page.tbs.alpha.canada.ca/bypage?page="+d+"</a></p>"),$("#details-panel3-lnk").closest("li").removeClass("hidden"),$("#details-panel3").removeClass("hidden")):($("#bp-content").html(""),$("#details-panel3-lnk").closest("li").addClass("hidden"),$("#details-panel3").addClass("hidden"),$("#details-panel3-lnk").parent().hasClass("active")&&($("#details-panel3-lnk").parent().removeClass("active"),$("#details-panel1-lnk").click()))}).catch(function(g){$("#bp-content").html("");$("#details-panel3-lnk").parent().addClass("hidden");$("#details-panel3-lnk").parent().hasClass("active")&&($("#details-panel3-lnk").parent().removeClass("active"),$("#details-panel1-lnk").click())})}),apiCallRead=(a,b,c,d)=>c.map(e=>{url="php/process-read.php";post={dates:a,url:b,oUrl:d,lang:document.documentElement.lang};e=new Request(url,{method:"POST",body:JSON.stringify(post)});return fetch(e).then(g=>g.json()).then(g=>{-1==g.html.indexOf("No data")?($("#read-content").html(g.html),$("#details-panel4-lnk").parent().removeClass("hidden")):($("#read-content").html(""),$("#details-panel4-lnk").parent().addClass("hidden"),$("#details-panel4-lnk").parent().hasClass("active")&&($("#details-panel4-lnk").parent().removeClass("active"),$("#details-panel3-lnk").click()))}).catch(function(g){$("#read-content").html("");$("#details-panel4-lnk").parent().addClass("hidden");$("#details-panel4-lnk").parent().hasClass("active")&&($("#details-panel4-lnk").parent().removeClass("active"),$("#details-panel3-lnk").click())})});function downloadPDF(){document.querySelector("#canvas-container");var a=new jsPDF("portrait");a.setFontSize(20);a.text(15,15,"Cool Chart");a.addImage(canvasImg,"PNG",10,10,280,150);a.save("canvas.pdf")}$("#urlform").submit(function(a){a.preventDefault();url=$("#urlval").val();$("#urlStatic").html(url);start=$(".dr-date-start").html();end=moment();mainQueue(url,start,end,0)});$("a#h2href").click(function(){event.preventDefault();url=$("#urlStatic").html();start=$(".dr-date-start").html();end=moment();1==$("#urlLang").html()?$("#urlLang").html(0):$("#urlLang").html(1);mainQueue(url,start,end,"1")});$("#ddRange").submit(function(a){a.preventDefault();url=$("#urlval").val();$("#urlStatic").html(url);start=$(".dr-date-start").html();end=moment();mainQueue(url,start,end,0)});function hideError(){$("#error").addClass("hidden")}function showError(){$("#error").removeClass("hidden");$("#errorHeader").text().includes("No data")?(errTrack="CRA-ARC:Page analytics tool - Error: No data",errKey="errorOccuredNodata"):$("#errorHeader").text().includes("429050")?(errTrack="CRA-ARC:Page analytics tool - Error: Too many requests",errKey="errorOccuredTooMany"):(errTrack="CRA-ARC:Page analytics tool - Error: Generic Error Message",errKey="errorOccured");$("#error-canvas").addClass("hidden");$("#error").attr("data-gc-analytics-customcall",errTrack);$(".error_display").attr("data-i18n",errKey);$(".error_display").text($.i18n(errKey));_satellite.track("CUSTOM_TRACK")}const removeQueryString=a=>{var b=document.createElement("a");b.href=a;b.search="";$href=b.href;/Edge/.test(navigator.userAgent)&&($href=$href.substring(0,$href.length-1));return $href},containsAny=(a,b)=>{for(var c=0;c!=b.length;c++){var d=b[c];if(-1!=a.indexOf(d))return d}return null},mainQueue=(a,b,c,d)=>{console.log(a);$("#canvas-container").addClass("hidden");$("#whole-canvas").addClass("hidden");$("#notfound").addClass("hidden");hideError();$("#loading").removeClass("hidden");$success=0;console.log(a);a=0===a.indexOf("www")?"https://"+a:a;if("https://"==a.substring(0,8)&&containsAny(a,substrings)){$isApp=/(apps[1-8].ams-sga.cra-arc.gc.ca)/.test(a)?1:0;console.log("isApp: "+$isApp);$isIntra=/(https:\/\/[^\/]+\.prv)/.test(a)?1:0;oUrl=a;a=a.substring(8,a.length);console.log(a);a=255<a.length?a.substring(a.length-255,a.length):a;moment.locale("en");$dd=$("#date-range").find(":selected").data("index");$.isNumeric($dd)||($dd=1);if(b&&c)vStart=b,e=c;else{b=moment();var e=moment().format("dddd MMMM DD, YYYY");0==$dd?vStart=moment(b).subtract(30,"days").format("dddd MMMM DD, YYYY"):1==$dd?vStart=moment(b).subtract(7,"days").format("dddd MMMM DD, YYYY"):2==$dd&&(vStart=moment(b).subtract(1,"days").format("dddd MMMM DD, YYYY"))}b=moment(vStart).format("YYYY-MM-DDTHH:mm:ss.SSS");c=moment(e).format("YYYY-MM-DDTHH:mm:ss.SSS");moment(e).subtract(1,"days").format("YYYY-MM-DDTHH:mm:ss.SSS");var g=[b,c];console.log(g);c=moment(vStart);b=moment(e);c.locale(document.documentElement.lang);b.locale(document.documentElement.lang);c=c.format("dddd MMMM DD, YYYY");b=b.subtract(1,"days").format("dddd MMMM DD, YYYY");$("#fromdaterange").html("<strong>"+c+"</strong>");$("#todaterange").html("<strong>"+b+"</strong>");b=moment(vStart);c=moment(e);dDay=c.diff(b,"days");dWeek=c.diff(b,"week",!0);$("#numDays").html(dDay);$("#numWeeks").html(dWeek);$("#searchBttn").prop("disabled",!0);var h=["dbGet"];console.log("language: "+d);if($isApp){var k=["trnd","prvs","metrics-new"];var m=1==$("#urlLang").html()?"fr":"en";a=a.substring(5,a.length)}else k=$isIntra?["trnd","prvs","metrics-new"]:"trnd prvs srchAll snmAll srchLeftAll activityMap metrics-new fwylf".split(" "),m="bi";var l="cntry qryAll qryMobile qryDesktop qryTablet totals totalDate".split(" ");console.log("language abbr: "+m);$isApp||$isIntra?e=Promise.resolve("null"):($("#loadGSC").html($.i18n("FetchdataGSC")),e=Promise.all(apiCallGSC2(g,a,h,oUrl,dDay,d)));e.then(n=>{n=$isApp||$isIntra?Promise.resolve($.i18n("Page-levelstatistics")):Promise.all([getPageH1(n[0].url)]);return n}).then(n=>{$("#h2title").html(n)}).then(()=>{$("#loadGSC").empty();$("#loadAA").html($.i18n("FetchdataAA"));a=$("#urlStatic").html();oUrl=$("#urlStatic").html();return Promise.all(apiCall2(g,a,h,oUrl,d))}).then(()=>{$("#loadAA").empty();$("#loadFD").html($.i18n("FetchdataFD"));$isApp?(oUrl2=a.substring(13,a.length),a=a.substring(13,a.length)):(a=$("#urlStatic").html(),oUrl2=$("#urlStatic").html());return Promise.all(apiCall(g,a,k,oUrl2,$dd,"aa",m))}).then(n=>{console.log("-----------------------------");console.log(n);n=extractJSON(n,"");console.log(n);$("#searchBttn").prop("disabled",!1);return Promise.resolve(n)}).then(n=>{console.log("LOOOG "+n);$isApp||$isIntra||(a=$("#urlStatic").html(),oUrl=$("#urlStatic").html(),dd=[$("#fromGSC").text(),$("#toGSC").text()],Promise.all(apiCall(dd,a,l,oUrl,$dd,"gsc",m)));return n}).then(n=>{console.log("log: "+n);-1!==$("#urlStatic").html().indexOf("/fr/")&&!$isApp||1==$("#urlLang").html()&&$isApp?$("a#h2href").html($.i18n("LanguageToggleFR")):$("a#h2href").html($.i18n("LanguageToggleEN"));$isApp?($("#rap-container").addClass("hidden"),$("#snum-container").addClass("hidden"),$("#search-container").addClass("hidden"),$("#fwlf-container").addClass("hidden"),$("#srchA-container").addClass("hidden"),$("#np-container").addClass("hidden"),$("#details-panel2-lnk").closest("li").addClass("hidden"),$("#details-panel2").addClass("hidden")):$isIntra?($("#rap-container").addClass("hidden"),$("#snum-container").addClass("hidden"),$("#search-container").addClass("hidden"),$("#fwlf-container").addClass("hidden"),$("#srchA-container").addClass("hidden"),$("#np-container").addClass("hidden"),$("#details-panel2-lnk").closest("li").addClass("hidden"),$("#details-panel2").addClass("hidden"),$("#h2href").addClass("hidden")):($("#rap-container").removeClass("hidden"),$("#snum-container").removeClass("hidden"),$("#search-container").removeClass("hidden"),$("#fwlf-container").removeClass("hidden"),$("#srchA-container").removeClass("hidden"),$("#np-container").removeClass("hidden"),$("#details-panel2-lnk").closest("li").removeClass("hidden"),$("#details-panel2").removeClass("hidden"));n?($("#loading").addClass("hidden"),$("#loadFD").empty(),$("#notfound").addClass("hidden"),showError(),$("#errorHeader").val($("#urlStatic").text()),$("#searchBttn").prop("disabled",!1),$("#urlval").val($("#urlStatic").text()),date=$("#date-range").val(),$("#loadComp").html($.i18n("FetchdataComplete")),setQueryParams(oUrl,date),$("#loadComp").empty()):($("#loading").addClass("hidden"),$("#loadFD").empty(),hideError(),$("#notfound").addClass("hidden"),$("#whole-canvas").removeClass("hidden"),$("#searchBttn").prop("disabled",!1),$("#urlval").val($("#urlStatic").text()),date=$("#date-range").val(),$("#loadComp").html($.i18n("FetchdataComplete")),setQueryParams(oUrl,date),$("#loadComp").empty(),$("#canvas-container").removeClass("hidden"));0==$dd?($("#gscDate").html($.i18n("Last30days")),$("#ddDate").html($.i18n("Last30days"))):1==$dd?($("#gscDate").html($.i18n("Last7days")),$("#ddDate").html($.i18n("Last7days"))):2==$dd&&($("#gscDate").html($.i18n("Yesterday")),$("#ddDate").html($.i18n("Yesterday")));2===$dd?($("#todaterange").addClass("hidden"),$("#to").addClass("hidden"),$("#todaterangegsc").addClass("hidden"),$("#gscto").addClass("hidden")):($("#todaterange").removeClass("hidden"),$("#to").removeClass("hidden"),$("#todaterangegsc").removeClass("hidden"),$("#gscto").removeClass("hidden"))}).catch(console.error.bind(console));$success=1}$success||($("#loading").addClass("hidden"),$("#notfound").removeClass("hidden"),$("#notfound").attr("data-gc-analytics-customcall","CRA-ARC Page analytics tool - Error:Search unsuccessful"),_satellite.track("CUSTOM_TRACK"))};
